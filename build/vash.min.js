(function(a){typeof define=="function"&&define.amd?define(a):typeof module=="object"&&module.exports?module.exports=a:window.vash=a})(function(a){function g(a,b){this.ast=a,this.originalMarkup=b||""}function f(a,b){var c;this.options=b||{},this.tokens=a,this.ast=d(f.modes.PRG)}function c(a){this.input=this.originalInput=a.replace(/\r\n|\r/g,"\n"),this.lineno=1,this.charno=0}var b=a;a.version="0.4.1-808",a.config={useWith:!1,modelName:"model",debug:!1,debugParser:!1,debugCompiler:!1},c.prototype={tok:function(a,b){return{type:a,line:this.lineno,chr:this.charno,val:b,toString:function(){return(this.mode?this.mode:"")+"["+this.type+" ("+this.line+","+this.chr+"): "+this.val+"]"}}},scan:function(a,b){var c,d;if(c=a.exec(this.input)){this.consume(c[0].length),d=this.tok(b,c[1]),this.charno+=c[0].length;return d}},spew:function(a){this.input=a+this.input,this.charno-=a.length},consume:function(a){this.input=this.input.substr(a)},spewIf:function(a,b){var c;a&&(c=a.val.split(b),c.length>1&&(a.val=c.shift(),this.spew(b+c.join(b))));return a},advance:function(){return this.next()},next:function(){return this.EMAIL()||this.AT_STAR_OPEN()||this.AT_STAR_CLOSE()||this.AT_COLON()||this.AT()||this.FAT_ARROW()||this.PAREN_OPEN()||this.PAREN_CLOSE()||this.HARD_PAREN_OPEN()||this.HARD_PAREN_CLOSE()||this.BRACE_OPEN()||this.BRACE_CLOSE()||this.TEXT_TAG_OPEN()||this.TEXT_TAG_CLOSE()||this.HTML_TAG_SELFCLOSE()||this.HTML_TAG_OPEN()||this.HTML_TAG_CLOSE()||this.PERIOD()||this.NEWLINE()||this.WHITESPACE()||this.FUNCTION()||this.KEYWORD()||this.HTML_RAW()||this.IDENTIFIER()||this.OPERATOR()||this.ASSIGN_OPERATOR()||this.LOGICAL()||this.DOUBLE_QUOTE()||this.SINGLE_QUOTE()||this.NUMERIC_CONTENT()||this.CONTENT()},AT:function(){return this.scan(/^(@)/,c.tks.AT)},AT_COLON:function(){return this.scan(/^@\:/,c.tks.AT_COLON)},AT_STAR_OPEN:function(){return this.scan(/^(@\*)/,c.tks.AT_STAR_OPEN)},AT_STAR_CLOSE:function(){return this.scan(/^(\*@)/,c.tks.AT_STAR_CLOSE)},PAREN_OPEN:function(){return this.scan(/^(\()/,c.tks.PAREN_OPEN)},PAREN_CLOSE:function(){return this.scan(/^(\))/,c.tks.PAREN_CLOSE)},BRACE_OPEN:function(){return this.scan(/^(\{)/,c.tks.BRACE_OPEN)},BRACE_CLOSE:function(){return this.scan(/^(\})/,c.tks.BRACE_CLOSE)},HARD_PAREN_OPEN:function(){return this.scan(/^(\[)/,c.tks.HARD_PAREN_OPEN)},HARD_PAREN_CLOSE:function(){return this.scan(/^(\])/,c.tks.HARD_PAREN_CLOSE)},TEXT_TAG_OPEN:function(){return this.scan(/^(<text>)/,c.tks.TEXT_TAG_OPEN)},TEXT_TAG_CLOSE:function(){return this.scan(/^(<\/text>)/,c.tks.TEXT_TAG_CLOSE)},HTML_TAG_SELFCLOSE:function(){return this.spewIf(this.scan(/^(<[^>]+?\/>)/,c.tks.HTML_TAG_SELFCLOSE),"@")},HTML_TAG_OPEN:function(){return this.spewIf(this.scan(/^(<[^\/ >]+?[^>]*?>)/,c.tks.HTML_TAG_OPEN),"@")},HTML_TAG_CLOSE:function(){return this.spewIf(this.scan(/^(<\/[^>\b]+?>)/,c.tks.HTML_TAG_CLOSE),"@")},FAT_ARROW:function(){return this.scan(/^(\(.*?\)?\s*?=>)/,c.tks.FAT_ARROW)},FUNCTION:function(){return this.scan(/^(function)(?![\d\w])/,c.tks.FUNCTION)},KEYWORD:function(){return this.scan(/^(case|catch|do|else|finally|for|function|goto|if|instanceof|return|switch|try|typeof|var|while|with)(?![\d\w])/,c.tks.KEYWORD)},IDENTIFIER:function(){return this.scan(/^([_$a-zA-Z\xA0-\uFFFF][_$a-zA-Z0-9\xA0-\uFFFF]*)/,c.tks.IDENTIFIER)},HTML_RAW:function(){return this.scan(/^(vash\.raw)(?![\d\w])/,c.tks.HTML_RAW)},PERIOD:function(){return this.scan(/^(\.)/,c.tks.PERIOD)},EMAIL:function(){return this.scan(/^([a-zA-Z0-9._%-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4})\b/,c.tks.EMAIL)},ASSIGN_OPERATOR:function(){return this.scan(/^(\|=|\^=|&=|>>>=|>>=|<<=|-=|\+=|%=|\/=|\*=|=)/,c.tks.ASSIGN_OPERATOR)},OPERATOR:function(){return this.scan(/^(===|!==|==|!==|>>>|<<|>>|>=|<=|>|<|\+|-|\/|\*|\^|%|\:|\?)/,c.tks.OPERATOR)},LOGICAL:function(){return this.scan(/^(&&|\|\||&|\||\^)/,c.tks.LOGICAL)},SINGLE_QUOTE:function(){return this.scan(/^(\\?')/,c.tks.SINGLE_QUOTE)},DOUBLE_QUOTE:function(){return this.scan(/^(\\?")/,c.tks.DOUBLE_QUOTE)},NUMERIC_CONTENT:function(){return this.scan(/^([0-9]+)/,c.tks.NUMERIC_CONTENT)},CONTENT:function(){return this.scan(/^([^\s})@.]+?)/,c.tks.CONTENT)},WHITESPACE:function(){return this.scan(/^(\s)/,c.tks.WHITESPACE)},NEWLINE:function(){var a=this.scan(/^(\n)/,c.tks.NEWLINE);a&&(this.lineno++,this.charno=0);return a},EOF:function(){return this.scan(/^$/,c.tks.EOF)}},c.tks={AT:"AT",AT_STAR_OPEN:"AT_STAR_OPEN",AT_STAR_CLOSE:"AT_STAR_CLOSE",AT_COLON:"AT_COLON",EMAIL:"EMAIL",PAREN_OPEN:"PAREN_OPEN",PAREN_CLOSE:"PAREN_CLOSE",BRACE_OPEN:"BRACE_OPEN",BRACE_CLOSE:"BRACE_CLOSE",HARD_PAREN_OPEN:"HARD_PAREN_OPEN",HARD_PAREN_CLOSE:"HARD_PAREN_CLOSE",TEXT_TAG_OPEN:"TEXT_TAG_OPEN",TEXT_TAG_CLOSE:"TEXT_TAG_CLOSE",HTML_TAG_SELFCLOSE:"HTML_TAG_SELFCLOSE",HTML_TAG_OPEN:"HTML_TAG_OPEN",HTML_TAG_CLOSE:"HTML_TAG_CLOSE",KEYWORD:"KEYWORD",FUNCTION:"FUNCTION",FAT_ARROW:"FAT_ARROW",IDENTIFIER:"IDENTIFIER",PERIOD:"PERIOD",ASSIGN_OPERATOR:"ASSIGN_OPERATOR",SINGLE_QUOTE:"SINGLE_QUOTE",DOUBLE_QUOTE:"DOUBLE_QUOTE",NUMERIC_CONTENT:"NUMERIC_CONTENT",OPERATOR:"OPERATOR",LOGICAL:"LOGICAL",CONTENT:"CONTENT",WHITESPACE:"WHITESPACE",NEWLINE:"NEWLINE",EOF:"EOF",HTML_RAW:"HTML_RAW"},c.pairs={AT_STAR_OPEN:c.tks.AT_STAR_CLOSE,PAREN_OPEN:c.tks.PAREN_CLOSE,BRACE_OPEN:c.tks.BRACE_CLOSE,HARD_PAREN_OPEN:c.tks.HARD_PAREN_CLOSE,DOUBLE_QUOTE:c.tks.DOUBLE_QUOTE,SINGLE_QUOTE:c.tks.SINGLE_QUOTE};var d=function(a){return new d.prototype.init(a)};d.prototype.vquery="yep",d.prototype.constructor=d,d.prototype.length=0,d.prototype.parent=null,d.prototype.mode=null,d.prototype.tagName=null,d.prototype.init=function(a){if(!a)return this;if(typeof a=="string"){this.mode=a;return this}if(!d.isArray(a)&&a.vquery!==this.vquery)a=[a];else if(a.length>=d.maxSize)throw{name:"vQuery Error",message:"Maximum number of elements exceeded"};return a.vquery===this.vquery?a:d.makeArray(a,this)},d.prototype.init.prototype=d.prototype,d.prototype.beget=function(a,b){var c=d();c.mode=a,c.parent=this,this.push(c),b&&(c.tagName=b);return c},d.prototype.every=function(a){"use strict";if(this==null)throw new TypeError;var b=Object(this),c=b.length>>>0;if(typeof a!="function")throw new TypeError;var d=arguments[1];for(var e=0;e<c;e++)if(e in b&&!a.call(d,b[e],e,b))return!1;return!0},d.prototype.each=function(a){d.each(this,a,this);return this},d.prototype.closest=function(a,b){var c=this;if(!b)while(c&&(c.mode!==a||c==this)&&c.parent&&(c=c.parent));else while(c)if(c.tagName!==b&&c.parent)c=c.parent;else break;return d(c)},d.prototype.pushFlatten=function(a){var b=a,c,d;while(b.length===1&&b[0].vquery)b=b[0];if(b.mode!==f.modes.PRG)this.push(b);else for(c=0;c<b.length;c++)this.push(b[c]);return this},d.prototype.push=function(a){d.isArray(a)?(a.vquery&&d.each(a,function(a){a.parent=this},this),Array.prototype.push.apply(this,a)):(a.vquery&&(a.parent=this),Array.prototype.push.call(this,a));return this.length},d.prototype.find=function(a,b){var c,e,f;b=b||[],d.isArray(a)||(a=d.parseSelector(a));for(c=0;c<this.length;c++){f=this[c],f.vquery&&f.find(a,b);for(e=0;e<a.length;e++)a[e](f)===!0&&b.push(f)}return b},d.prototype.root=function(){var a=this;while(a&&a.parent&&(a=a.parent));return a},d.prototype.toTreeString=function(){function c(e){var f,g;a.push(Array(b).join(" |")+" +"+e.mode+" "+(e.tagName||"")),b+=1,f=e.slice();while(g=f.shift())g.vquery===d.prototype.vquery?c(g):a.push(Array(b).join(" |")+" "+(g?g.toString():"[empty]"));b-=1}var a=[],b=1;c(this);return a.join("\n")},d.maxSize=5e5,d.parseSelector=function(a){var b=a.split(","),c,d,e,f,g=[];for(e=0;e<b.length;e++)c=b[e].replace(/^\s+/,"").replace(/\s+$/,""),c[0]==="["&&c[c.length-1]==="]"&&(c=c.substring(1,c.length-1),(d=c.indexOf("!="))?g.push(function(a,b){return function(c){return c[a]!==b}}(c.substring(0,d),c.substring(d+2))):(d=c.indexOf("="))&&g.push(function(a,b){return function(c){return c[a]===b}}(c.substring(0,d),c.substring(d+2))));return g},d.makeArray=function(a,b){a=Array.prototype.slice.call(a,0);if(b){b.push.apply(b,a),b.mode=a.mode,b.parent=a.parent,b.tagName=a.tagName;return b}return a},d.isArray=function(a){return Object.prototype.toString.call(a)=="[object Array]"},d.each=function(a,b,c){var d,e;for(d=0;d<a.length;d++)e=a[d],b.call(c||e,e,d)},d.copyObj=function(a){var b={};for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);return b},d.takeMethodsFromArray=function(){var a=["pop","push","reverse","shift","sort","splice","unshift","concat","join","slice","indexOf","lastIndexOf","filter","forEach","every","map","some","reduce","reduceRight"],b=[],c;for(var e=0;e<a.length;e++)c=a[e],typeof b[c]=="function"&&!d.prototype[c]&&function(a){d.prototype[a]=function(){return b[a].apply(this,d.makeArray(arguments))}}(c)},d.takeMethodsFromArray();var e={makeNode:function(a,b){var c=[];c.mode=a,c.isASTNode=!0,c.parent=b||null;return c},makeMarkupNode:function(a,b){var c=e.makeNode(f.modes.MKP,b);c.tagName=a;return c},findNodeOfMode:function(a,b){var c,d;for(c=0;c<a.length;c++){d=a[c];if(d.isASTNode&&d.mode===b)return d}},findAncestor:function(a,b){var c=a.parent;while(c&&c.mode!==b&&c.parent&&(c=c.parent));return c},root:function(a){var b=a.parent;while(b&&b.parent&&(b=b.parent));return b}};f.modes={PRG:"PROGRAM",MKP:"MARKUP",BLK:"BLOCK",EXP:"EXPRESSION"},f.prototype={parse:function(){var a,b,c,d;while(a=this.tokens.pop()){this.options.debugParser&&console.log(this.ast&&this.ast.mode,a.type,a,a.val);if(this.ast.mode===f.modes.PRG||this.ast.mode===null)this.ast=this.ast.beget(this.options.initialMode||f.modes.MKP),this.options.initialMode===f.modes.EXP&&(this.ast=this.ast.beget(f.modes.EXP));if(this.ast.mode===f.modes.MKP){this.handleMKP(a);continue}if(this.ast.mode===f.modes.BLK){this.handleBLK(a);continue}if(this.ast.mode===f.modes.EXP){this.handleEXP(a);continue}}this.ast=this.ast.root(),this.options.debugParser&&!this.options.initialMode&&(console.log(this.ast),console.log(this.ast.toTreeString()));return this.ast},exceptionFactory:function(a,b,c){switch(b){case"UNMATCHED":a.name="UnmatchedCharacterError",this.ast.root(),c&&(a.message="Unmatched "+c.type+" at line "+c.line+", character "+c.chr+". Value: "+c.val+"\n "+this.ast.toTreeString(),a.lineNumber=c.line);break;case"INVALIDINPUT":a.name="InvalidParserInputError",c&&(this.message="Asked to parse invalid or non-string input: "+c),this.lineNumber=0}return a},advanceUntilNot:function(a){var b,c,d=[];while(c=this.tokens[this.tokens.length-1])if(c.type===a)b=this.tokens.pop(),d.push(b);else break;return d},advanceUntilMatched:function(a,b,c,d){var e=a,f=null,g=0,h=0,i=[];while(e){e.type===b&&g++,e.type===c&&(h++,f&&f.type===d&&h--),i.push(e);if(g===h)break;f=e,e=this.tokens.pop();if(!e)throw this.exceptionFactory(new Error,"UNMATCHED",a)}return i.reverse()},handleMKP:function(a){var b=this.tokens[this.tokens.length-1],d=this.tokens[this.tokens.length-2],e=null,g;switch(a.type){case c.tks.AT_STAR_OPEN:this.advanceUntilMatched(a,c.tks.AT_STAR_OPEN,c.tks.AT_STAR_CLOSE,c.tks.AT);break;case c.tks.AT:if(b)switch(b.type){case c.tks.PAREN_OPEN:case c.tks.IDENTIFIER:case c.tks.HTML_RAW:this.ast.length===0&&(this.ast=this.ast.parent,this.ast.pop()),this.ast=this.ast.beget(f.modes.EXP);break;case c.tks.KEYWORD:case c.tks.FUNCTION:case c.tks.BRACE_OPEN:case c.tks.BLOCK_GENERATOR:this.ast.length===0&&(this.ast=this.ast.parent,this.ast.pop()),this.ast=this.ast.beget(f.modes.BLK);break;default:this.ast.push(this.tokens.pop())}break;case c.tks.BRACE_OPEN:this.ast=this.ast.beget(f.modes.BLK),this.tokens.push(a);break;case c.tks.BRACE_CLOSE:this.ast=this.ast.parent,this.tokens.push(a);break;case c.tks.TEXT_TAG_OPEN:case c.tks.HTML_TAG_OPEN:e=a.val.match(/^<([^\/ >]+)/i),e===null&&b&&b.type===c.tks.AT&&d&&(e=d.val.match(/(.*)/)),this.ast.tagName?this.ast=this.ast.beget(f.modes.MKP,e[1]):this.ast.tagName=e[1],c.tks.HTML_TAG_OPEN===a.type&&this.ast.push(a);break;case c.tks.TEXT_TAG_CLOSE:case c.tks.HTML_TAG_CLOSE:e=a.val.match(/^<\/([^>]+)/i),e===null&&b&&b.type===c.tks.AT&&d&&(e=d.val.match(/(.*)/)),g=this.ast.closest(f.modes.MKP,e[1]),g!==null&&g.tagName===e[1]&&(this.ast=g),c.tks.HTML_TAG_CLOSE===a.type&&this.ast.push(a),this.ast.parent&&this.ast.parent.mode===f.modes.BLK&&(b.type===c.tks.WHITESPACE||b.type===c.tks.NEWLINE)&&(this.ast=this.ast.parent);break;case c.tks.HTML_TAG_SELFCLOSE:this.ast.push(a),this.ast.parent&&this.ast.parent.mode===f.modes.BLK&&(b.type===c.tks.WHITESPACE||b.type===c.tks.NEWLINE)&&(this.ast=this.ast.parent);break;default:this.ast.push(a)}},handleBLK:function(a){var b=this.tokens[this.tokens.length-1],e,g,h,i,j,k;switch(a.type){case c.tks.AT:switch(b.type){case c.tks.AT:break;default:this.tokens.push(a),this.ast=this.ast.beget(f.modes.MKP)}break;case c.tks.AT_COLON:this.ast=this.ast.beget(f.modes.MKP);break;case c.tks.TEXT_TAG_OPEN:case c.tks.TEXT_TAG_CLOSE:case c.tks.HTML_TAG_SELFCLOSE:case c.tks.HTML_TAG_OPEN:case c.tks.HTML_TAG_CLOSE:this.ast=this.ast.beget(f.modes.MKP),this.tokens.push(a);break;case c.tks.FAT_ARROW:this.ast=this.ast.beget(f.modes.BLK);break;case c.tks.BRACE_OPEN:case c.tks.PAREN_OPEN:i=d.copyObj(this.options),i.initialMode=f.modes.BLK,h=this.advanceUntilMatched(a,a.type,c.pairs[a.type],c.tks.AT),h.pop(),g=h.shift(),this.ast.push(a),j=new f(h,i),j.parse(),this.ast.pushFlatten(j.ast),this.ast.push(g),h=this.advanceUntilNot(c.tks.WHITESPACE),b=this.tokens[this.tokens.length-1],b&&b.type!==c.tks.KEYWORD&&b.type!==c.tks.FUNCTION&&b.type!==c.tks.BRACE_OPEN&&a.type!==c.tks.PAREN_OPEN?(this.tokens.push.apply(this.tokens,h.reverse()),this.ast=this.ast.parent):this.ast.push(h);break;case c.tks.WHITESPACE:this.ast.push(a),this.advanceUntilNot(c.tks.WHITESPACE);break;default:this.ast.push(a)}},handleEXP:function(a){var b=null,e,g,h,i,j,k;switch(a.type){case c.tks.KEYWORD:case c.tks.FUNCTION:this.ast=this.ast.beget(f.modes.BLK),this.tokens.push(a);break;case c.tks.LOGICAL:case c.tks.ASSIGN_OPERATOR:case c.tks.OPERATOR:case c.tks.NUMERIC_CONTENT:this.ast.parent&&this.ast.parent.mode===f.modes.EXP?this.ast.push(a):(this.ast=this.ast.parent,this.tokens.push(a));break;case c.tks.WHITESPACE:case c.tks.IDENTIFIER:case c.tks.HTML_RAW:this.ast.push(a);break;case c.tks.SINGLE_QUOTE:case c.tks.DOUBLE_QUOTE:this.ast.parent&&this.ast.parent.mode===f.modes.EXP?this.ast.push(a):(this.ast=this.ast.parent,this.tokens.push(a));break;case c.tks.HARD_PAREN_OPEN:case c.tks.PAREN_OPEN:h=d.copyObj(this.options),h.initialMode=f.modes.EXP,j=this.advanceUntilMatched(a,a.type,c.pairs[a.type],c.tks.AT),j.pop(),g=j.shift(),this.ast.push(a),i=new f(j,h),i.parse(),this.ast.pushFlatten(i.ast),this.ast.push(g),b=this.tokens[this.tokens.length-1],this.ast.parent&&this.ast.parent.mode!==f.modes.EXP&&b&&b.type!==c.tks.HARD_PAREN_OPEN&&b.type!==c.tks.PERIOD&&(this.ast=this.ast.parent);break;case c.tks.BRACE_OPEN:this.tokens.push(a),this.ast=this.ast.beget(f.modes.BLK);break;case c.tks.FAT_ARROW:this.tokens.push(a),this.ast=this.ast.beget(f.modes.BLK);break;case c.tks.PERIOD:b=this.tokens[this.tokens.length-1],!b||b.type!==c.tks.IDENTIFIER&&b.type!==c.tks.KEYWORD&&b.type!==c.tks.FUNCTION?(this.ast=this.ast.parent,this.tokens.push(a)):this.ast.push(a);break;default:this.ast.parent&&this.ast.parent.mode!==f.modes.EXP?(this.ast=this.ast.parent,this.tokens.push(a)):this.ast.push(a)}}};var h=g.prototype;h.assemble=function(a){function q(a){return a.vquery&&a.mode===f.modes.EXP?a.filter(q).length>0:a.vquery&&a.mode!==f.modes.EXP?!0:!1}function p(a){var b,c=a.slice(0),d,e,g;a.mode===f.modes.EXP&&a.parent&&a.parent.mode!==f.modes.EXP&&(d=a.filter(q).length);for(e=0;e<c.length;e++){g=c[e];if(g.vquery){p(g);continue}a.mode===f.modes.MKP?m(g,a,e):a.mode===f.modes.BLK?n(g,a,e):a.mode===f.modes.EXP&&o(g,a,e,d>0?!1:!0)}}function o(h,i,j,k){var m="",n="",o=i.parent&&i.parent.mode!==f.modes.EXP;a.htmlEscape!==!1&&(h.type===c.tks.HTML_RAW&&d.push(!0),o&&j===0&&k&&d.length===0&&(m+="( typeof (__vtemp = "),o&&j===i.length-1&&k&&(d.length>0?d.pop():n+=") !== 'undefined' ? __vtemp : '' ).toString()\n.replace(/&(?!w+;)/g, '&amp;')\n.replace(/</g, '&lt;')\n.replace(/>/g, '&gt;')\n.replace(/\"/g, '&quot;') \n")),o&&(j===0||j===1&&i[0].type===c.tks.HTML_RAW)&&(l(h),m="__vout.push("+m),o&&(j===i.length-1||j===i.length-2&&i[i.length-1].type===c.tks.HTML_RAW)&&(n+="); \n"),h.type!==c.tks.HTML_RAW&&b.push(m+h.val.replace(e,'"').replace(g,'"')+n),o&&j===i.length-1&&l(h)}function n(a,c,d){b.push(a.val.replace(e,'"'))}function m(a,c,d){l(a),b.push("__vout.push('"+a.val.replace(e,'"').replace(i,"\\n")+"'); \n")}function l(c){a.debug&&(b.push("__vline = "+c.line+", "),b.push("__vchar = "+c.chr+"; \n"))}a=a||{};var b=[],d=[],e=/["']/gi,g=/(\\?)(["'])/gi,i=/[\n\r]/gi,j,k;b.unshift("var __vout = [], __vtemp; \n"),a.debug&&b.push("var __vline = 0, __vchar = 0; \n"),p(this.ast),a.useWith===!0&&(b.unshift("with("+a.modelName+" || {}){ \n"),b.push("}")),a.debug&&(b.unshift("try { \n"),b.push("} catch(e){ (",h.reportError.toString(),")(e, __vline, __vchar, ",'"'+this.originalMarkup.replace(i,"!LB!").replace(g,"\\$2")+'"',") } \n")),b.push("return __vout.join('');"),j=b.join(""),a.debugCompiler&&console.log(j);try{k=new Function(a.modelName,j)}catch(r){r.message+=" -> "+j;throw r}return k},h.reportError=function(a,b,c,d){var e=d.split("!LB!"),f=3,g=Math.max(0,b-f),h=Math.min(e.length,b+f),i=e.slice(g,h).map(function(a,c,d){var e=c+g+1;return(e===b?"  > ":"    ")+e+" | "+a}).join("\n");a.message="Problem while rendering template at line "+b+", character "+c+".\nOriginal message: "+a.message+"."+"\nContext: \n\n"+i+"\n\n";throw a},a.VLexer=c,a.VParser=f,a.VCompiler=g,a.compile=function i(b,d){if(b===""||typeof b!="string")throw new Error("Empty or non-string cannot be compiled");var e,h,i=[],j,k,l;d=d||{},d.useWith=d.useWith||a.config.useWith,d.modelName=d.modelName||a.config.modelName,d.debug=d.debug||a.config.debug,d.debugParser=d.debugParser||a.config.debugParser,d.debugCompiler=d.debugCompiler||a.config.debugCompiler,e=new c(b);while(h=e.advance())i.push(h);i.reverse(),j=new f(i,d),j.parse(),k=new g(j.ast,b),l=k.assemble(d),l.displayName="render";return l};return a}({}))